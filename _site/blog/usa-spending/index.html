<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chuck Horgan">
<meta name="dcterms.date" content="2022-09-12">

<title>Chuck Horgan - USA Spending - Server Config and Automated Refresh</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Chuck Horgan</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../home.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about/about.html">About</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/blog.html">Blog</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../snippets/snippets.html">Code Snippets</a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a>
  <ul class="collapse">
  <li><a href="#what-is-usa-spending" id="toc-what-is-usa-spending" class="nav-link" data-scroll-target="#what-is-usa-spending">What is USA Spending?</a></li>
  <li><a href="#how-are-awards-reported" id="toc-how-are-awards-reported" class="nav-link" data-scroll-target="#how-are-awards-reported">How are Awards Reported?</a></li>
  <li><a href="#data-insights-from-experience" id="toc-data-insights-from-experience" class="nav-link" data-scroll-target="#data-insights-from-experience">Data Insights From Experience</a></li>
  </ul></li>
  <li><a href="#why-restore-the-full-database" id="toc-why-restore-the-full-database" class="nav-link" data-scroll-target="#why-restore-the-full-database">Why Restore the Full Database?</a></li>
  <li><a href="#requirements" id="toc-requirements" class="nav-link" data-scroll-target="#requirements">Requirements</a></li>
  <li><a href="#server-setup" id="toc-server-setup" class="nav-link" data-scroll-target="#server-setup">Server Setup</a>
  <ul class="collapse">
  <li><a href="#first-steps" id="toc-first-steps" class="nav-link" data-scroll-target="#first-steps">First Steps</a></li>
  <li><a href="#install-required-software" id="toc-install-required-software" class="nav-link" data-scroll-target="#install-required-software">Install Required Software</a></li>
  <li><a href="#install-quality-of-life-software" id="toc-install-quality-of-life-software" class="nav-link" data-scroll-target="#install-quality-of-life-software">Install Quality of Life Software</a></li>
  <li><a href="#configure-everything" id="toc-configure-everything" class="nav-link" data-scroll-target="#configure-everything">Configure Everything</a></li>
  </ul></li>
  <li><a href="#restore-script" id="toc-restore-script" class="nav-link" data-scroll-target="#restore-script">Restore Script</a>
  <ul class="collapse">
  <li><a href="#quick-start" id="toc-quick-start" class="nav-link" data-scroll-target="#quick-start">Quick Start</a></li>
  <li><a href="#global-parameters" id="toc-global-parameters" class="nav-link" data-scroll-target="#global-parameters">Global Parameters</a></li>
  <li><a href="#compare-database-versions" id="toc-compare-database-versions" class="nav-link" data-scroll-target="#compare-database-versions">Compare Database Versions</a></li>
  <li><a href="#begin-update-or-exit-process" id="toc-begin-update-or-exit-process" class="nav-link" data-scroll-target="#begin-update-or-exit-process">Begin Update or Exit Process</a></li>
  </ul></li>
  <li><a href="#scheduling" id="toc-scheduling" class="nav-link" data-scroll-target="#scheduling">Scheduling</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">USA Spending - Server Config and Automated Refresh</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Research</div>
    <div class="quarto-category">Server</div>
    <div class="quarto-category">PostgreSQL</div>
    <div class="quarto-category">Cron</div>
    <div class="quarto-category">Linux</div>
    <div class="quarto-category">Bash</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Chuck Horgan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 12, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<section id="what-is-usa-spending" class="level2">
<h2 class="anchored" data-anchor-id="what-is-usa-spending">What is USA Spending?</h2>
<ul>
<li><p><a href="">USAspending.gov</a> is the official source for U.S. Government spending data.</p></li>
<li><p>Its mission is to show the American public what the federal government spends every year and how it spends the money.</p></li>
<li><p>You can follow the money from Congressional appropriations to federal agencies and down to local communities and businesses.</p></li>
<li><p>Data is uploaded directly from more than a hundred federal agenciesâ€™ financial systems. Data is also pulled or derived from other government systems.</p></li>
</ul>
</section>
<section id="how-are-awards-reported" class="level2">
<h2 class="anchored" data-anchor-id="how-are-awards-reported">How are Awards Reported?</h2>
<ul>
<li><p>The Federal Funding Accountability and Transparency Act of 2006 (FFATA) was signed into law on September 26, 2006</p></li>
<li><p>The legislation required that federal contract, grant, loan, and other financial assistance awards of <strong>more than $25,000</strong> be displayed on a publicly accessible and searchable website to give the American public access to information on how their tax dollars are being spent.</p></li>
<li><p>In 2008, FFATA was amended by the Government Funding Transparency Act, which required prime recipients to report details on their first-tier sub-recipients for awards made as of October 1,</p>
<ol start="2010" type="1">
<li></li>
</ol></li>
<li><p>The transparency efforts of FFATA were expanded with the enactment of the Digital Accountability and Transparency Act (DATA Act) Pub. L. 113-101 on May 9, 2014.</p></li>
<li><p>Publication of Department of Defense (DOD) and U.S. Army Corps of Engineers (USACE) data in FPDS is delayed 90 days.</p></li>
<li><p>All other data is delayed 30 days.</p></li>
</ul>
</section>
<section id="data-insights-from-experience" class="level2">
<h2 class="anchored" data-anchor-id="data-insights-from-experience">Data Insights From Experience</h2>
<ul>
<li><p>It seems like the DATA Act of 2014 yielded the most reliable DoD award data.</p></li>
<li><p>Anomalies/inconsistencies have been observed in earlier data, but it is still useful to cross-reference with other sources.</p></li>
</ul>
</section>
</section>
<section id="why-restore-the-full-database" class="level1">
<h1>Why Restore the Full Database?</h1>
<p>The USA Spending site itself provides an intuitive, robust interface for finding data. You can use an [advanced search]() query to drill down to awards, download data to CSVs, and explore interactive visualizations. Furthermore, the API has large variety of documented endpoints. Why then, would you want to go through the process of restoring the entire database?</p>
<ol type="1">
<li>You are not finding what you need on the site or API endpoints. The site interface and its downloads do not include all fields contained within the database.</li>
<li>You want to rely on static, locally-stored data.</li>
<li>You are envisioning automated/scheduled scripts as part of larger production processes.</li>
<li>You want to learn how to restore a database and/or some bash scripting and server management.</li>
</ol>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Although the database opens doors to more complex solutions, the database and restore process are not without their shortfalls.</p>
<ul>
<li><p>From what Iâ€™ve seen so far, the database is not structured in a manner that facilitates efficient <a href="https://en.wikipedia.org/wiki/ACID">ACID transactions</a>.</p></li>
<li><p>Before I began this process, I knew almost nothing about server management, linux, database management, or bash scripting. After exhausting all of my connections, I went forward with a simplistic solution. However, that process has been running without error for two years now!</p></li>
<li><p>That being said, there <em>must</em> be better ways to do this. If you have ideas, let me know in the comments!</p></li>
</ul>
</div>
</div>
</section>
<section id="requirements" class="level1">
<h1>Requirements</h1>
<p>While the data may technically be restored to any sufficiently-sized server or database platform, this process utilizes a PostgreSQL server hosted on an on-prem <a href="https://wiki.ubuntu.com/">Ubuntu</a> 20 (<a href="https://wiki.ubuntu.com/FocalFossa">Focal Fossa</a>) instance. The supplied <a href="https://files.usaspending.gov/database_download/usaspending-db-setup.pdf">restore script</a> on USA Spending utilized this setup, so I started from there.</p>
<table class="table">
<caption><em>Table 1 - Requirements</em></caption>
<colgroup>
<col style="width: 24%">
<col style="width: 40%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Item</th>
<th>Requirement</th>
<th>Importance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Hardware</td>
<td>Continuously-running server</td>
<td>Critical</td>
</tr>
<tr class="even">
<td>Storage</td>
<td>At least 4-5 TB</td>
<td>Critical</td>
</tr>
<tr class="odd">
<td>Computing Resources</td>
<td>32 GB RAM, 8-core processor</td>
<td>Low, depends on refresh time preferences/necessity</td>
</tr>
<tr class="even">
<td>Operating System</td>
<td>Ubuntu 20 (Focal Fossa)</td>
<td>High</td>
</tr>
<tr class="odd">
<td>Database Platform</td>
<td>PostgreSQL 10 (or later)</td>
<td>Medium</td>
</tr>
<tr class="even">
<td>Dependencies</td>
<td>A lightweight assortment of basic packages</td>
<td>Medium, this process depends on them, but may be done with user-preferred packages</td>
</tr>
<tr class="odd">
<td>Permissions</td>
<td>Root/sudo user on Ubuntu server</td>
<td>Critical</td>
</tr>
<tr class="even">
<td>Prior Knowledge</td>
<td>Some understanding of basic CLI for Linux and PostgreSQL, database principles, and patience</td>
<td>Low, hopefully this guide covers it all!</td>
</tr>
</tbody>
</table>
<p>This process will explain most of the Linux commands necessary, but for a introduction, check out my <em>Linux Common Commands</em> snippet.</p>
</section>
<section id="server-setup" class="level1">
<h1>Server Setup</h1>
<p>I was given root credentials to a completely blank server with Ubuntu freshly installed. If you have a mature server with Postgres and common packages already installed, go ahead and skip to the Restore Script.</p>
<section id="first-steps" class="level2">
<h2 class="anchored" data-anchor-id="first-steps">First Steps</h2>
<ul>
<li><p>putty and user</p></li>
<li><p>(optional) link to setup of xrdp</p></li>
<li><p>partition drives!</p></li>
</ul>
</section>
<section id="install-required-software" class="level2">
<h2 class="anchored" data-anchor-id="install-required-software">Install Required Software</h2>
<ul>
<li><p>PostgreSQL</p></li>
<li><p>various dependencies</p></li>
</ul>
</section>
<section id="install-quality-of-life-software" class="level2">
<h2 class="anchored" data-anchor-id="install-quality-of-life-software">Install Quality of Life Software</h2>
<ul>
<li>(optional) emacs</li>
</ul>
</section>
<section id="configure-everything" class="level2">
<h2 class="anchored" data-anchor-id="configure-everything">Configure Everything</h2>
<ul>
<li><p>Postgres port</p></li>
<li><p>restart service</p></li>
</ul>
</section>
</section>
<section id="restore-script" class="level1">
<h1>Restore Script</h1>
<ul>
<li><p>each step explained below</p></li>
<li><p>skip to Quick Start (link somehow) if comfortable with basic commands and postgresql</p></li>
<li><p>script designed to be run daily, easier to keep this in mind</p></li>
</ul>
<section id="quick-start" class="level2">
<h2 class="anchored" data-anchor-id="quick-start">Quick Start</h2>
<p>If youâ€™re familiar with bash/Postgres and just trying to get this running on your server, save the following file as <code>update_DB.sh</code> in your update directory, change the parameters at the top, and execute the file. If you wish to schedule it, see the Scheduling section below.</p>
<p>(embed the script? with github maybe?) hiya</p>
</section>
<section id="global-parameters" class="level2">
<h2 class="anchored" data-anchor-id="global-parameters">Global Parameters</h2>
</section>
<section id="compare-database-versions" class="level2">
<h2 class="anchored" data-anchor-id="compare-database-versions">Compare Database Versions</h2>
</section>
<section id="begin-update-or-exit-process" class="level2">
<h2 class="anchored" data-anchor-id="begin-update-or-exit-process">Begin Update or Exit Process</h2>
</section>
</section>
<section id="scheduling" class="level1">
<h1>Scheduling</h1>
<ul>
<li><p>cron explanation</p></li>
<li><p>crontab line</p></li>
<li><p>explanation</p></li>
</ul>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<ul>
<li><p>learned a lot</p></li>
<li><p>took a few iterations to get right</p></li>
<li><p>added checks incrementally</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>